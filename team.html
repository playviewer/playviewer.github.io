<html>
  <head>
    <style>
    table, th, td {
      border: 1px solid black;
    }
    </style>
  </head>
  <body>
    <h1>PVR - Team</h1>
    <h1 id="team"></h1>
    <table id="players">
      <tr>
        <th>Name</th>
        <th>IGN</th>
        <th>Ranks</th>
      </tr>
    </table>
    <h3>Match History</h3>
    <table id="mHistory">
      <tr>
        <th>Date</th>
        <th>Status</th>
        <th>Opponent</th>
        <th>Games Won</th>
        <th>Games Lost</th>
      </tr>
    </table>
    <script>
    function GetURLParams() {
      var url = window.location.href;
      var regex = /[?&]([^=#]+)=([^&#]*)/g,
        params = {},
        match;
      while (match = regex.exec(url)) {
        params[match[1]] = match[2];
      }
      return params;
    }
    id = GetURLParams().id

    function Get(yourUrl) { // credit https://stackoverflow.com/a/22790025/5038158
      var Httpreq = new XMLHttpRequest(); // a new request
      Httpreq.open("GET",yourUrl,false);
      Httpreq.send(null);
      return Httpreq.responseText;
    }

    teams = JSON.parse(Get("https://playviewer.github.io/data.json")); // text
    teams = teams.teams
    index = 0
    for (var i = 0; i < teams.length; i++) {
      if (teams[i][0] == id) {
        index = i
      }
    }
    console.log(teams[index])
    document.getElementById("team").innerText = teams[index][1].team.name + " - " + teams[index][1].team.school.name
    members = teams[index][1].team.members
    for (var i = 0; i < members.length; i++) {
      row = "<tr>"
      row = row + "<th>"+members[i].name+"</th>"
      row = row + "<th>"+members[i].steamAccount.steamPersonaName+"</th>"
      row = row + "<th><a href=\"https://rocketleague.tracker.network/profile/steam/"+members[i].steamAccount.steamId+"\">Rank</a></th>"
      row = row + "</tr>"
      document.getElementById("players").innerHTML = document.getElementById("players").innerHTML + row
    }

    for (var i = 0; i < teams[index][2].length; i++) {
      row = "<tr>"
      row = row + "<th>"+teams[index][2][i].scheduledStartsAt.split("T")[0]+"</th>"
      row = row + "<th>"+teams[index][2][i].status+"</th>"
      if (teams[index][2][i].matchResults[0].team.name == teams[index][1].team.name) {
        row = row + "<th><a href=\"https://playviewer.github.io/team.html?id="+teams[index][2][i].matchResults[1].team.id+"\">"+teams[index][2][i].matchResults[1].team.name+"</a></th>"
        row = row + "<th>"+teams[index][2][i].matchResults[0].gamesWon+"</th>"
        row = row + "<th>"+teams[index][2][i].matchResults[0].gamesLost+"</th>"
      } else {
        row = row + "<th><a href=\"https://playviewer.github.io/team.html?id="+teams[index][2][i].matchResults[0].team.id+"\">"+teams[index][2][i].matchResults[0].team.name+"</a></th>"
        row = row + "<th>"+teams[index][2][i].matchResults[1].gamesWon+"</th>"
        row = row + "<th>"+teams[index][2][i].matchResults[1].gamesLost+"</th>"
      }
      row = row + "</tr>"
      document.getElementById("mHistory").innerHTML = document.getElementById("mHistory").innerHTML + row
    }

    </script>
  </body>
</html>
